{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Tarefas</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static "style.css" %}">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<body>

  <header>

    <div class="search">
      <form action="{% url "search" %}" method="GET">
        <input type="search" class="search-input" placeholder="Search" id="search" name="q" value={{ request.GET.q.strip }}>
      </form>
    </div>

  </header>


  <div class="container">

    <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">
      Adicionar tarefas
    </button>

      <form action="{% url "create_task" %}" method='POST'>
        {% csrf_token %}
        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
          <div class="modal-dialog">

          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <input type="text" name="nova_tarefa" required id="nova_tarefa" placeholder="Nova tarefa">
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
              <button type="submit" class="btn btn-primary">Salvar</button>
            </div>
          </div>
        </form>

        </div>
      </div>

    </div>

  <main class="content">

    <div class='responsive-table'>

      <table class="tasks-table">

        <caption class='table-caption'>
          Tarefas
        </caption>

        <tbody>
          {% for task in tasks %}
            <tr class="table-row">
              <form action="{% url "mark_task" task.id %}" method="post">
                {% csrf_token %}
                <td class="table-cel">
                  <button type="submit" name="{{ task.id }}">

                {% if task.task_completed %}
                    <input type="checkbox" id="{{ task.id }}" name="{{ task.id }}" checked>
                    <label for="{{ task.id }}"><s>{{ task }}</s></label>
                  </button>
                </td>

                {% else %}
                    <input type="checkbox" id="{{ task.id }}" name="{{ task.id }}">
                    <label for="{{ task.id }}">{{ task }}</label>
                  </button>
                </td>
                {% endif %}

              </form>

                <form action="{% url "delete_task" task.id %}" method="POST">
                  {% csrf_token %}
                  <td class='table-cel'>
                    <button type="submit" name="delete {{ task.id }}">
                      APAGAR TAREFA
                    </button>
                  </td>

                </form>

            </tr>
          {% endfor %}

        </tbody>

      </table>

    </div>

  </main>

</body>

</html>
